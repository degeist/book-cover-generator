<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="De Geist">

    <title>{% if page.title %}{{ page.title | escape }} - {{ site.title | escape }}{% else %}{{ site.title | escape }}{% endif %}</title>
    <meta name="description" content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% else %}{{ site.description }}{% endif %}">

    <link rel="stylesheet" href="{{ site.baseurl }}/css/main.css">

    <link rel="canonical" href="{{ page.url | replace:'index.html','' | prepend: site.baseurl | prepend: site.url }}">

    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="{{ "/favicon.ico" | prepend: site.baseurl }}">
    <link rel="apple-touch-icon" sizes="57x57" href="{{ "/img/favicons/apple-icon-57x57.png" | prepend: site.baseurl }}">
    <link rel="apple-touch-icon" sizes="60x60" href="{{ "/img/favicons/apple-icon-60x60.png" | prepend: site.baseurl }}">
    <link rel="apple-touch-icon" sizes="72x72" href="{{ "/img/favicons/apple-icon-72x72.png" | prepend: site.baseurl }}">
    <link rel="apple-touch-icon" sizes="76x76" href="{{ "/img/favicons/apple-icon-76x76.png" | prepend: site.baseurl }}">
    <link rel="apple-touch-icon" sizes="114x114" href="{{ "/img/favicons/apple-icon-114x114.png" | prepend: site.baseurl }}">
    <link rel="apple-touch-icon" sizes="120x120" href="{{ "/img/favicons/apple-icon-120x120.png" | prepend: site.baseurl }}">
    <link rel="apple-touch-icon" sizes="144x144" href="{{ "/img/favicons/apple-icon-144x144.png" | prepend: site.baseurl }}">
    <link rel="apple-touch-icon" sizes="152x152" href="{{ "/img/favicons/apple-icon-152x152.png" | prepend: site.baseurl }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ "/img/favicons/apple-icon-180x180.png" | prepend: site.baseurl }}">
    <link rel="icon" type="image/png" sizes="192x192"  href="{{ "/img/favicons/android-icon-192x192.png" | prepend: site.baseurl }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ "/img/favicons/favicon-32x32.png" | prepend: site.baseurl }}">
    <link rel="icon" type="image/png" sizes="96x96" href="{{ "/img/favicons/favicon-96x96.png" | prepend: site.baseurl }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ "/img/favicons/favicon-16x16.png" | prepend: site.baseurl }}">
    <link rel="manifest" href="{{ "/img/favicons/manifest.json" | prepend: site.baseurl }}">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="{{ "/img/favicons/ms-icon-144x144.png" | prepend: site.baseurl }}">
    <meta name="theme-color" content="#ffffff">

    <!-- / Facebook Open Graph shares -->
    <meta content='{{ site.title }}' property='og:title'>
    <meta content='{{ site.url }}' property='og:url'>
    <meta content='{{ site.name }}' property='og:site_name'>
    <meta content='{{ site.description }}' property='og:description'>
    <meta content='{{ "/img/social-media/fb.jpg" | prepend: site.url }}' property='og:image'>
    <!-- / Twitter cards -->
    <meta content='summary_large_image' name='twitter:card'>
    <meta content='@{{ site.twitter_username }}' name='twitter:site'>
    <meta content='{{ site.description }}' name='twitter:title'>
    <meta content='{{ site.description }}' name='twitter:description'>
    <meta content='{{ "/img/social-media/twitter.jpg" | prepend: site.url }}' name='twitter:image'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- / Vendor scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.2/js/tether.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/js/bootstrap.min.js" integrity="sha384-vZ2WRJMwsjRMW/8U7i6PWi6AlO1L79snBrmgiDpgIWJ82z8eA5lenwvxbMV1PAh7" crossorigin="anonymous"></script>
    <script src="{{ "/js/vendor/jquery.inline-edit.js" | prepend: site.baseurl }}"></script>
    <script src="{{ "/js/vendor/fileuploader/jquery.ui.widget.js" | prepend: site.baseurl }}"></script>
    <script src="{{ "/js/vendor/fileuploader/jquery.iframe-transport.js" | prepend: site.baseurl }}"></script>
    <script src="{{ "/js/vendor/fileuploader/jquery.fileupload.js" | prepend: site.baseurl }}"></script>
    <script src="{{ "/js/ui.js" | prepend: site.baseurl }}"></script>
    <script src="{{ "/js/dropzone.js" | prepend: site.baseurl }}"></script>
    <script src="{{ "/js/vendor/canvas2image.js" | prepend: site.baseurl }}"></script>

  </head>
  <body>
    {{ content }}
  </body>
  <script>
  function loadImages(sources, callback) {
    var images = {};
    var loadedImages = 0;
    var numImages = 0;
    // get num of sources
    for(var src in sources) {
      numImages++;
    }
    for(var src in sources) {
      images[src] = new Image();
      images[src].onload = function() {
        if(++loadedImages >= numImages) {
          callback(images);
        }
      };
      images[src].src = sources[src];
    }
  }

  window.onload = function(images) {
      var canvas = document.getElementById("myCanvas");
      var ctx = canvas.getContext("2d");

      var sources = {
        background: "/img/artboard/backgrounds/dummy-bg1.jpg",
        overlayImg: "/img/artboard/dummy-cutout.png"
      };


      loadImages(sources, function(images) {
        ctx.drawImage(images.background, 0, 0, 500, 700);
        ctx.drawImage(images.overlayImg, 0, 0, 250, 250);
        // save canvas image as data url (png format by default)
        ctx.font         = '68px BookType';
        ctx.fillStyle = 'black';
        ctx.textBaseline = 'top';
        ctx.fillText  ('Dan & Phil', 20, 20);
        var dataURL = canvas.toDataURL();
        // set canvasImg image src to dataURL
        document.getElementById("canvasImg").src = dataURL;
      });
    };



  // Output canvas to datauri
  $(document).ready(function() {
    var canvas = document.getElementById("canvas"),
        ctx = canvas.getContext("2d");

    canvas.width = 500;
    canvas.height = 700;
    //
    // var background = new Image();
    // background.src = '/img/artboard/dummy-cutout-small-test-version.png';

    var overlayImg = new Image();
    overlayImg.src = '/img/artboard/dummy-cutout-small-test-version.png';
    //'/img/artboard/dummy-cutout.png';


    overlayImg.onload = function() {
        // ctx.drawImage(background,0,0, 500, 700);
        ctx.drawImage(overlayImg,75,75, 250, 500);
        ctx.font         = '68px BookType';
        ctx.fillStyle = 'black';
        ctx.textBaseline = 'top';
        ctx.fillText  ('Dan & Phil', 20, 20);
    };

    // Copy canvas to image
    function convertCanvasToImage(canvas) {
      var image = new Image();
      image.src = canvas.toDataURL("image/png");
      return image;
    };

    var convertedImg = convertCanvasToImage(canvas);

    $('#copy-canvas').on('click', function(){
      $('#output').append(convertedImg);
      console.log(canvas);
      console.log(convertedImg);
    })
  });

  </script>


</html>
